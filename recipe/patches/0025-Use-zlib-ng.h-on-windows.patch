From 5248a46154b3ca6bc9b7f3546dfa40c319b16486 Mon Sep 17 00:00:00 2001
From: "Uwe L. Korn" <uwelk@xhochy.com>
Date: Mon, 21 Jul 2025 20:03:19 +0200
Subject: [PATCH 25/25] Use zlib-ng.h on windows

---
 Modules/binascii.c   | 6 +++++-
 Modules/zlibmodule.c | 6 +++++-
 2 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/Modules/binascii.c b/Modules/binascii.c
index 6bb01d148b6..2dd2505b0f1 100644
--- a/Modules/binascii.c
+++ b/Modules/binascii.c
@@ -61,7 +61,11 @@
 #include "pycore_long.h"          // _PyLong_DigitValue
 #include "pycore_strhex.h"        // _Py_strhex_bytes_with_sep()
 #ifdef USE_ZLIB_CRC32
-#  include "zlib.h"
+#  ifdef WIN32
+#    include "zlib-ng.h"
+#  else
+#    include "zlib.h"
+#  endif
 #endif
 
 typedef struct binascii_state {
diff --git a/Modules/zlibmodule.c b/Modules/zlibmodule.c
index d4b4b91697c..758781ad943 100644
--- a/Modules/zlibmodule.c
+++ b/Modules/zlibmodule.c
@@ -9,7 +9,11 @@
 
 #include "Python.h"
 
-#include "zlib.h"
+#ifdef WIN32
+#  include "zlib-ng.h"
+#else
+#  include "zlib.h"
+#endif
 #include "stdbool.h"
 #include <stddef.h>               // offsetof()
 
